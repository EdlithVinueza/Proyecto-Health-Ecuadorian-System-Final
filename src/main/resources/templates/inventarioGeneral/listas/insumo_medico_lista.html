<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    </meta>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    </meta>
    <title th:text="${tituloPestaña}"></title>
    <!--Icono de la Pestaña-->
    <link rel="icon" href="../../../static/img/Logo.png" th:href="@{../../../img/Logo.png}">
    </link>
    <!--Bootstrap usamos una version anterior (5.3.0) para el estilo de las tablas-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    </link>
    <!--Estilos de letras-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=DM+Serif+Display:ital@0;1&display=swap"
        rel="stylesheet">
    <!--Iconos-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
<!--Estilos CSS-->
    <!--Formulario-->
    <link rel="stylesheet" href="../../../static/cssInventario/style_listas.css"
        th:href="@{/cssInventario/style_listas.css}">
    <!--Botones-->
    <link rel="stylesheet" href="../../../static/cssInventario/style_botones.css"
        th:href="@{/cssInventario/style_botones.css}">
    <!--Mnesaje usuario-->
    <link rel="stylesheet" href="../../../static/cssInventario/style_mensajes_usuario.css"
        th:href="@{/cssInventario/style_mensajes_usuario.css}">
    <!--Navbar General-->
    <link rel="stylesheet" href="../../../static/cssInventario/style_navbar.css" th:href="@{/cssInventario/style_navbar.css}">
    <!--SVG General-->
    <link rel="stylesheet" href="../../../static/cssInventario/style_svg.css" th:href="@{/cssInventario/style_svg.css}">
    <style>
        body {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>

<body>
    <!--Navbar-->
      <nav th:replace="inventarioGeneral/menus/navbar_admi_inventario :: navbar_admi_inventario"></nav>

    <div class="container-mensaje">
        <div th:if="${msgExito}" class="mensaje-exito" role="alert">
            <p th:text="${msgExito}"></p>
        </div>
        <div th:if="${msgError}" class="mensaje-error" role="alert">
            <p th:text="${msgError}"></p>
        </div>
        <div th:if="${msgEliminacionExitosa}" class="mensaje-exito" role="alert">
            <p th:text="${msgEliminacionExitosa}"></p>
        </div>

    </div>

    <!--Tabla de Roles-->
    <div class="container-lista">
        <h6  style="margin-bottom: 20px;" >Formas de busqueda</h6>
        <div class="botones-busqueda-container d-flex align-items-center" style="margin-top: 10px;">
            <div class="d-flex justify-content-start" style="width: 100%;">
                <form th:action="@{/administracion-inventario/insumo-buscar-por-codigo}" method="post" class="d-flex">
                    <div class="input-group mb-0">
                        <input type="text" id="codigo" name="codigo" class="form-control" placeholder="Codigo Insumo"
                            style="width: 125px; height: 40px; " required>
                        &nbsp;
                        <div class="input-group-append" style="margin-top: 3px;">
                            <button type="submit" class="btn btn-info">Por Código</button>
                        </div>
                    </div>
                </form>
                &nbsp;
                &nbsp;
                <form th:action="@{/administracion-inventario/insumo-buscar-por-proveedor}" method="post"
                    class="d-flex">
                    <div class="input-group mb-0">
                        <input type="text" id="proveedor" name="proveedor" class="form-control"
                            placeholder="Ruc o Empresa" style="width: 130px; height: 40px;" required>
                        &nbsp;
                        <div class="input-group-append" style="margin-top: 3px;">
                            <button type="submit" class="btn btn-info">Por Proveedor</button>
                        </div>
                    </div>
                </form>
                &nbsp;
                &nbsp;
                <form th:action="@{/administracion-inventario/insumo-buscar-por-nombre-comun}" method="post"
                    class="d-flex">
                    <div class="input-group mb-0">
                        <input type="text" id="nombreComun" name="nombreComun" class="form-control"
                            placeholder="Nombre Comun" style="width: 140px; height: 40px;" required>
                        &nbsp;
                        <div class="input-group-append" style="margin-top: 3px;">
                            <button type="submit" class="btn btn-info">Por Nombre</button>
                        </div>
                    </div>
                </form>
                &nbsp;
                &nbsp;
                <a th:href="@{/administracion-inventario/proveedor-ver-todo}" method="get" role="button"
                    class="btn btn-primary" style="margin-top: 3px;">Ver Todo</a>
                &nbsp;
                &nbsp;
                <!-- Botón de descarga PDF -->
                <a th:href="@{/administracion-inventario/insumo-generar-pdf}" class="btn btn-danger me-2"
                    target="_blank" style="margin-top: 3px;"> <svg xmlns="http://www.w3.org/2000/svg" width="16"
                        height="16" fill="currentColor" class="bi bi-file-pdf-fill" viewBox="0 0 16 16">
                        <path
                            d="M5.523 10.424q.21-.124.459-.238a8 8 0 0 1-.45.606c-.28.337-.498.516-.635.572l-.035.012a.3.3 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548m2.455-1.647q-.178.037-.356.078a21 21 0 0 0 .5-1.05 12 12 0 0 0 .51.858q-.326.048-.654.114m2.525.939a4 4 0 0 1-.435-.41q.344.007.612.054c.317.057.466.147.518.209a.1.1 0 0 1 .026.064.44.44 0 0 1-.06.2.3.3 0 0 1-.094.124.1.1 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256M8.278 4.97c-.04.244-.108.524-.2.829a5 5 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.5.5 0 0 1 .145-.04c.013.03.028.092.032.198q.008.183-.038.465z" />
                        <path fill-rule="evenodd"
                            d="M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2m.165 11.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.6 11.6 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.86.86 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.84.84 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.8 5.8 0 0 0-1.335-.05 11 11 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.24 1.24 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a20 20 0 0 1-1.062 2.227 7.7 7.7 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103" />
                    </svg> &nbsp;PDF</a>
            </div>
        </div>
        <div class="table-container">

            <div>
                <h1 class="table-titulo" th:text="${tituloLista}"></h1>
            </div>
            <div class="table__body text-center">
                <table class="table table-hover">
                    <thead>
                        <!--Encabezado de la Tabla-->
                        <tr class="table-active table-info">
                            <th>Id</th>
                            <th>Nombre Empresa</th>
                            <th>Ruc</th>
                            <th>Nombre Insumo</th>
                            <th>Código</th>
                            <th>Stock</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="insumo: ${listaInsumoMedico}">
                            <td th:text="${insumo.id}"></td>
                            <td th:text="${insumo.proveedor.nombreEmpresa}"></td>
                            <td th:text="${insumo.proveedor.ruc}"></td>
                            <td th:text="${insumo.nombre}"></td>
                            <td th:text="${insumo.codigo}"></td>
                            <td th:text="${insumo.stock}"></td>
                            <td>
                                <a th:href="@{/administracion-inventario/insumo-actualizar/{codigo}(codigo=${insumo.codigo})}"
                                    role="button" class="btn btn-warning">Actualizar</a>
                                &nbsp;
                                <a th:href="@{/administracion-inventario/insumo-ver-mas-detalles/{codigo}(codigo=${insumo.codigo})}"
                                    role="button" class="btn btn-info">Ver más</a>
                            </td>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <div class="fixed-bottom text-end me-3 mb-3 ">
        <a th:href="@{${returnUrl}}" class="boton-regresar btn " role="button">Regresar</a>
    </div>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <!--JAVA SCRIPT-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous">
        </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const formCodigo = document.querySelector('form[action$="insumo-buscar-por-codigo"]');
            const formProveedor = document.querySelector('form[action$="insumo-buscar-por-proveedor"]');
            const formNombreComun = document.querySelector('form[action$="insumo-buscar-por-nombre-comun"]');

            formCodigo.addEventListener('submit', function () {
                localStorage.clear();
                localStorage.setItem('codigo', document.getElementById('codigo').value);
            });

            formProveedor.addEventListener('submit', function () {
                localStorage.clear();
                localStorage.setItem('proveedor', document.getElementById('proveedor').value);
            });

            formNombreComun.addEventListener('submit', function () {
                localStorage.clear();
                localStorage.setItem('nombreComun', document.getElementById('nombreComun').value);
            });

            if (localStorage.getItem('codigo')) {
                document.getElementById('codigo').value = localStorage.getItem('codigo');
            }

            if (localStorage.getItem('proveedor')) {
                document.getElementById('proveedor').value = localStorage.getItem('proveedor');
            }

            if (localStorage.getItem('nombreComun')) {
                document.getElementById('nombreComun').value = localStorage.getItem('nombreComun');
            }
        });
    </script>
</body>

</html>